some code comes from client-go.